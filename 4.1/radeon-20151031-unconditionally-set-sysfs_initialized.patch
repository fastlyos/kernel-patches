
Bug: https://bugzilla.kernel.org/show_bug.cgi?id=106851

Signed-off-by: Holger Hoffst√§tte <holger.hoffstaette@googlemail.com>

--- linux/drivers/gpu/drm/radeon/radeon_pm.c~	2015-10-31 13:32:34.000000000 +0100
+++ linux/drivers/gpu/drm/radeon/radeon_pm.c	2015-10-31 13:55:50.098388605 +0100
@@ -1539,7 +1539,7 @@
 					DRM_ERROR("failed to create device file for dpm state\n");
 				ret = device_create_file(rdev->dev, &dev_attr_power_dpm_force_performance_level);
 				if (ret)
-					DRM_ERROR("failed to create device file for dpm state\n");
+					DRM_ERROR("failed to create device file for dpm forced performance level\n");
 				/* XXX: these are noops for dpm but are here for backwards compat */
 				ret = device_create_file(rdev->dev, &dev_attr_power_profile);
 				if (ret)
@@ -1547,8 +1547,7 @@
 				ret = device_create_file(rdev->dev, &dev_attr_power_method);
 				if (ret)
 					DRM_ERROR("failed to create device file for power method\n");
-				if (!ret)
-					rdev->pm.sysfs_initialized = true;
+				rdev->pm.sysfs_initialized = true;
 			}
 
 			mutex_lock(&rdev->pm.mutex);
@@ -1574,8 +1573,7 @@
 			ret = device_create_file(rdev->dev, &dev_attr_power_method);
 			if (ret)
 				DRM_ERROR("failed to create device file for power method\n");
-			if (!ret)
-				rdev->pm.sysfs_initialized = true;
+			rdev->pm.sysfs_initialized = true;
 		}
 	}
 	return ret;
